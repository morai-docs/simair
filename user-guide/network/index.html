<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="MORAI Engineering Service Team" /><link rel="canonical" href="https://morai-docs.github.io/simair-cirrus/user-guide/network/" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Network Configuration - MORAI SIM Air - Cirrus</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
        <link href="../../assets/_mkdocstrings.css" rel="stylesheet" />
        <link href="../../css/custom.css" rel="stylesheet" />
        <link href="../../css/extra.css" rel="stylesheet" />
        <link href="../../css/theme_extra.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Network Configuration";
        var mkdocs_page_input_path = "user-guide\\network.md";
        var mkdocs_page_url = "/simair-cirrus/user-guide/network/";
      </script>
    
    <script src="../../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/yaml.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> MORAI SIM Air - Cirrus
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="" href="../..">üè† Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../release-notes/">üóÇÔ∏è Release Note</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">About this Document</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../about/revision-history/">Revision History</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../about/overview/">Document Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../about/terms-conventions/">Terminology and Conventions</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Introduction</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../intro/morai-simair/">About MORAI SIM: Air</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Gettign Started</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../getting-started/installation/">Installation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../getting-started/ui/">User Interface</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Using MORAI SIM Air</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../basic-controls/">Basic Controls</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">Network Configuration</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#supported-communication-method">Supported communication method</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#receiving-aircraft-control-messages">Receiving Aircraft Control Messages</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#step-1-subscribe-to-ros2-messages">Step 1: Subscribe to ROS2 messages</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#step-2-udp-network-setting-in-the-simulator">Step 2: UDP network setting in the simulator</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#1-activate-the-network-menu">1) Activate the network menu</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#2-configure-host-ipport">2) Configure Host IP/Port</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#3-network-connection">3) Network connection</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#step-3-send-messages-from-external-server">Step 3: Send messages from external server</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#sending-sensor-messages">Sending Sensor Messages</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#step-1-senosr-network-settings-in-the-simulator">Step 1: Senosr network settings in the simulator</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#1-place-sensors-on-the-aircraft">1) Place sensors on the aircraft</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#2-configure-destination-ipport">2) Configure Destination IP/Port</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#3-network-connection_1">3) Network connection</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#step-2-publishing-to-ros2">Step 2: Publishing to ROS2</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#network-message-specifications">Network Message Specifications</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#udp-recieve-messages">UDP Recieve Messages</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#cirrus_tx">Cirrus_tx</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#cirrus_controlposition">Cirrus_ControlPosition</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#cirrus_braking">Cirrus_Braking</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#cirrus_engine">Cirrus_Engine</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../sensors/">Sensor Settings</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">MORAI SIM Air - Cirrus</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" alt="Docs"></a> &raquo;</li>
          <li>Using MORAI SIM Air &raquo;</li>
      <li>Network Configuration</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/morai-docs/simair-cirrus/blob/main/docs/user-guide/network.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="network-configuration">Network Configuration<a class="headerlink" href="#network-configuration" title="Permanent link">ÔÉÅ</a></h1>
<p>This section describes the configuration of the network environment of MORAI SIM: Air, the setting method for data communication between external systems, and sending/receiving messages.</p>
<hr />
<h2 id="supported-communication-method">Supported communication method<a class="headerlink" href="#supported-communication-method" title="Permanent link">ÔÉÅ</a></h2>
<p>MORAI SIM: Air supports UDP and ROS2 for network communication between the simulator and external systems.</p>
<p><a href="https://en.wikipedia.org/wiki/User_Datagram_Protocol">UDP</a> is a widely used network protocol for transmitting data over the internet, while <a href="https://docs.ros.org/en/rolling/index.html">ROS2 (Robot Operating System 2)</a> is a popular middleware for robotics and automation applications. <br>
The MORAI SIM: Air simulator allows for sending sensor data and receiving aircraft control messages using either UDP or ROS2 communication methods. </p>
<p>To communicate with MORAI SIM: Air, <br>
Depending on the simulator's message transmission/reception method, the following network settings are required.</p>
<figure>
    <img src="../../img/network-configure.png" style="width: 1000px; height: auto;" alt="sensor" title="Click to Enlage" onclick="window.open(this.src)">
    <figcaption style="padding-top: 10px;"><b> Figure 1. Network communication method supported by MORAI SIM: Air</b></figcaption>
</figure>

<ul>
<li>
<p>MORAI SIM: Air sends sensor data to an external system</p>
<ol>
<li><strong>UDP Network Settings</strong> in each sensor model in the simulator</li>
<li>Receive UDP messages and publish to ROS2 using <strong>UDP to ROS2 Bridge</strong></li>
</ol>
</li>
<li>
<p>MORAI SIM: Air receives aircraft control messages from an external system</p>
<ol>
<li><strong>UDP Network Settings</strong> provided by the simulator (Subscriber IP/Port setting)</li>
<li>Subscribe to ROS2 messages and them over UDP using <strong>UDP to ROS2 Bridge</strong></li>
</ol>
</li>
</ul>
<p>The UDP to ROS2 Bridge serves to connect data between the UDP-based simulator and the ROS2 system by receiving and transmitting UDP signals and issuing and subscribing to ROS2 as shown below.</p>
<figure>
    <img src="../../img/network-ros2bridge.png" style="width: 1000px; height: auto;" alt="sensor" title="Click to Enlage" onclick="window.open(this.src)">
    <figcaption style="padding-top: 10px;"><b> Figure 2. Role of 'UDP to ROS2 Bridge'</b></figcaption>
</figure>

<div markdown="span" class="bs-callout bs-callout-danger">
‚ö†Ô∏è  <span class = "dan-calloutTitle"> WARNING </span> <br>
The current simulator does not provide direct support for transmitting/receiving ROS2 messages. Therefore, <b>UDP to ROS2 Bridge</b> should be used for ROS2 communication with an external system.
</div>

<h2 id="receiving-aircraft-control-messages">Receiving Aircraft Control Messages<a class="headerlink" href="#receiving-aircraft-control-messages" title="Permanent link">ÔÉÅ</a></h2>
<p>When the simulator receives control messages by ROS2 communication, <br>
Configure the ROS2 to UDP communication environment and set the network of the simulator in the order below.</p>
<h3 id="step-1-subscribe-to-ros2-messages">Step 1: Subscribe to ROS2 messages<a class="headerlink" href="#step-1-subscribe-to-ros2-messages" title="Permanent link">ÔÉÅ</a></h3>
<p>For this step, you need to install and run <strong>UDP to ROS2 Bridge</strong>.</p>
<div markdown="span" class="bs-callout bs-callout-success">
‚úÖ <span class = "suc-calloutTitle"> TIPS </span> <br>See the <a href="https://morai.atlassian.net/wiki/external/1372881223/NzI2NTk2NWU0ODBjNDJmYTkwOGRjZDBiMWEwMmZhMzI">UDP to ROS2 Bridge User Guide</a> provided separately.
</div>

<h3 id="step-2-udp-network-setting-in-the-simulator">Step 2: UDP network setting in the simulator<a class="headerlink" href="#step-2-udp-network-setting-in-the-simulator" title="Permanent link">ÔÉÅ</a></h3>
<h4 id="1-activate-the-network-menu">1) Activate the network menu<a class="headerlink" href="#1-activate-the-network-menu" title="Permanent link">ÔÉÅ</a></h4>
<p>Click <strong>Network</strong> in the top left menu as shown below.
<img src="../../img/network-setting.png" style="width: 1000px; height: auto;" alt="sensor" title="Click to Enlage" onclick="window.open(this.src)"></p>
<h4 id="2-configure-host-ipport">2) Configure Host IP/Port<a class="headerlink" href="#2-configure-host-ipport" title="Permanent link">ÔÉÅ</a></h4>
<p>The method of receiving aircraft control messages in the simulator consists of <strong>GHOST MODE</strong> and <strong>EXTERNAL CTRL</strong> protocol.</p>
<p>Configure the Host IP/Port as below to operate the aircraft in <strong>GHOST MODE</strong> by receiving external control messages.</p>
<ul>
<li>Host IP: Enter the IP of the host PC running the simulator</li>
<li>Host Port: Enter the Port of Host PC</li>
</ul>
<p>Host IP/Port configuration method for <strong>EXTERNAL CTRL</strong> protocol is the same as above.</p>
<h4 id="3-network-connection">3) Network connection<a class="headerlink" href="#3-network-connection" title="Permanent link">ÔÉÅ</a></h4>
<p>Click <strong>Connect</strong> at the bottom <strong>PROTOCOL_SUB_GHOSTMODE</strong> or <strong>PROTOCOL_SUB_EXTERNALCTRL</strong>. <br>
Then, it enters into a standby state in which a control message can be received.</p>
<h3 id="step-3-send-messages-from-external-server">Step 3: Send messages from external server<a class="headerlink" href="#step-3-send-messages-from-external-server" title="Permanent link">ÔÉÅ</a></h3>
<p>Send a message from the external server to the simulator using UDP to ROS2 Bridge.</p>
<ul>
<li>Send coordinates by playing rosbag file</li>
<li>Send UDP packet</li>
</ul>
<p>UDP messages received by each mode are as follows.</p>
<ul>
<li>GHOST MODE:<ul>
<li><code>Cirrus_tx</code></li>
</ul>
</li>
<li>EXTERNAL CTRL: <ul>
<li><code>CIRRUS_CONTROL_POSITION</code>,   // 101  SIM -&gt; JSBSim</li>
<li><code>CIRRUS_BRAKING</code>,            // 102</li>
<li><code>CIRRUS_ENGINE</code>,             // 103</li>
</ul>
</li>
</ul>
<div markdown="span" class="bs-callout bs-callout-success">
‚úÖ <span class = "suc-calloutTitle"> TIPS </span> <br>
For details on the types and detailed structure of UDP messages received in GHOST MODE or EXTERNAL CTRL, see the <a href=#udp-recieve-messages>UDP Recieve Messages</a> section.
</div>

<h2 id="sending-sensor-messages">Sending Sensor Messages<a class="headerlink" href="#sending-sensor-messages" title="Permanent link">ÔÉÅ</a></h2>
<h3 id="step-1-senosr-network-settings-in-the-simulator">Step 1: Senosr network settings in the simulator<a class="headerlink" href="#step-1-senosr-network-settings-in-the-simulator" title="Permanent link">ÔÉÅ</a></h3>
<h4 id="1-place-sensors-on-the-aircraft">1) Place sensors on the aircraft<a class="headerlink" href="#1-place-sensors-on-the-aircraft" title="Permanent link">ÔÉÅ</a></h4>
<div markdown="span" class="bs-callout bs-callout-success">
‚úÖ <span class = "suc-calloutTitle"> TIPS </span> <br>
For details on how to place the sensor, see the <a href="https://morai.atlassian.net/wiki/external/1372881223/NzI2NTk2NWU0ODBjNDJmYTkwOGRjZDBiMWEwMmZhMzI">Sensor Settings</a> part.
</div>

<h4 id="2-configure-destination-ipport">2) Configure Destination IP/Port<a class="headerlink" href="#2-configure-destination-ipport" title="Permanent link">ÔÉÅ</a></h4>
<p>Configure Destination IP/Port for UDP network in <strong>Network Settings</strong> at the bottom of the sensor setting window.</p>
<p><img src="../../img/network-sensor.png" style="width: 500px; height: auto;" alt="sensor" title="Click to Enlage" onclick="window.open(this.src)"></p>
<ul>
<li><strong>Destination IP</strong> and <strong>Port</strong>: <ul>
<li>Enter the IP and port of the target server that transmits sensor data in the simulator.</li>
<li>In case of ROS2 communication in the server, enter the IP and Port of the server where UDP to ROS2 Bridge is installed.</li>
</ul>
</li>
</ul>
<h4 id="3-network-connection_1">3) Network connection<a class="headerlink" href="#3-network-connection_1" title="Permanent link">ÔÉÅ</a></h4>
<p>Click <strong>Connect</strong> at the bottom of <strong>Network Settings</strong>. <Br>
Then, it enters into a standby state in which sensor messages can be transmitted.</p>
<h3 id="step-2-publishing-to-ros2">Step 2: Publishing to ROS2<a class="headerlink" href="#step-2-publishing-to-ros2" title="Permanent link">ÔÉÅ</a></h3>
<p>For this step, you need to install and run <strong>UDP to ROS2 Bridge</strong>.</p>
<div markdown="span" class="bs-callout bs-callout-success">
‚úÖ <span class = "suc-calloutTitle"> TIPS </span> <br>See the <a href="https://morai.atlassian.net/wiki/external/1372881223/NzI2NTk2NWU0ODBjNDJmYTkwOGRjZDBiMWEwMmZhMzI">UDP to ROS2 Bridge User Guide</a> provided separately.
</div>

<h2 id="network-message-specifications">Network Message Specifications<a class="headerlink" href="#network-message-specifications" title="Permanent link">ÔÉÅ</a></h2>
<p>This section describes details such as the type and format of messages received and transmitted by MORAI SIM: Air as described above.</p>
<h3 id="udp-recieve-messages">UDP Recieve Messages<a class="headerlink" href="#udp-recieve-messages" title="Permanent link">ÔÉÅ</a></h3>
<p>The data structure and packets for each UDP message sent from the external Cirrus system to MORAI SIM are as follows.</p>
<h4 id="cirrus_tx">Cirrus_tx<a class="headerlink" href="#cirrus_tx" title="Permanent link">ÔÉÅ</a></h4>
<p><pre class="highlight"><code class="language-python">struct Cirrus_Tx
{
    float lon;              // deg
    float lat;              // deg
    float alt;              // ft
    float heading;          // deg
    float roll;             // deg
    float pitch;            // deg
    float sur_aileron;      // [-1 ~ 1]
    float sur_flap;         // [-1 ~ 1]
    float sur_elevator;     // [-1 ~ 1]
    float sur_rudder;       // [-1 ~ 1]
};</code></pre>
<Br>
<img src="../../img/cirrus_tx.drawio.png" style="width: 1000px; height: auto;" alt="sensor" title="Click to Enlage" onclick="window.open(this.src)"></p>
<h4 id="cirrus_controlposition">Cirrus_ControlPosition<a class="headerlink" href="#cirrus_controlposition" title="Permanent link">ÔÉÅ</a></h4>
<p><pre class="highlight"><code class="language-python">struct Cirrus_ControlPosition
{
    float SetDaCmd;             // get_aileron              -1 ~ +1
    float SetRollTrimCmd;       // get_aileron_trim         (-0.1 ~ +0.1)
    float SetDeCmd;             // get_elevator             -1 ~ +1
    float SetPitchTrimCmd;      // get_elevator_trim        (-0.1 ~ +0.1)
    float SetDrCmd;             // get_rudder               -1 ~ +1                 
    float SetDsCmd;             // get_rudder               -1 ~ +1                 
    float SetYawTrimCmd;        // get_rudder_trim          (-0.1 ~ +0.1)
    float SetDfCmd;             // get_flaps                0 ~ 1
};</code></pre>
<Br>
<img src="../../img/Cirrus_ControlPosition.drawio.png" style="width: 1000px; height: auto;" alt="sensor" title="Click to Enlage" onclick="window.open(this.src)"></p>
<h4 id="cirrus_braking">Cirrus_Braking<a class="headerlink" href="#cirrus_braking" title="Permanent link">ÔÉÅ</a></h4>
<p><pre class="highlight"><code class="language-python">struct Cirrus_Braking
{
    float SetBrake;             // Left + Right             0~1   
};</code></pre>
<Br>
<img src="../../img/Cirrus_Braking.drawio.png" style="width: auto; height: auto;" alt="sensor" title="Click to Enlage" onclick="window.open(this.src)"></p>
<h4 id="cirrus_engine">Cirrus_Engine<a class="headerlink" href="#cirrus_engine" title="Permanent link">ÔÉÅ</a></h4>
<p><pre class="highlight"><code class="language-python">struct Cirrus_Engine
{
    float SetThrottleCmd;      // get_throttle(i)           0~1
};</code></pre>
<Br>
<img src="../../img/Cirrus_Engine.drawio.png" style="width: auto; height: auto;" alt="sensor" title="Click to Enlage" onclick="window.open(this.src)"></p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../basic-controls/" class="btn btn-neutral float-left" title="Basic Controls"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../sensors/" class="btn btn-neutral float-right" title="Sensor Settings">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
      <p>Copyright &copy; 2023 <a href="https://www.morai.ai">MORAI Inc.</a> Maintained by the <a href="https://github.com/morai-docs">MORAI-Docs Team.</a></p>
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/morai-docs/simair-cirrus" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../basic-controls/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../sensors/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme_extra.js" defer></script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
